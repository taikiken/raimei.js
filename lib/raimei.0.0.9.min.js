/*
 inazumatv.com
 @author (at)taikiken / http://inazumatv.com
 @date 2014/04/19 - 16:37

 Copyright (c) 2011-2014 inazumatv.com, inc.

 Distributed under the terms of the MIT license.
 http://www.opensource.org/licenses/mit-license.html

 This notice shall be included in all copies or substantial portions of the Software.
*/
var RAIMEI={};
(function(c){var a=c.self;a.console=a.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};Date.now||(Date.now=function(){return(new Date).getTime()});(function(){for(var f=0,e=["ms","moz","webkit","o"],d=0;d<e.length&&!a.requestAnimationFrame;++d)a.requestAnimationFrame=a[e[d]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[e[d]+"CancelAnimationFrame"]||a[e[d]+"CancelRequestAnimationFrame"];void 0===a.requestAnimationFrame&&void 0!==a.setTimeout&&
(a.requestAnimationFrame=function(b){var d=Date.now(),e=Math.max(0,16-(d-f)),c=a.setTimeout(function(){b(d+e)},e);f=d+e;return c});void 0===a.cancelAnimationFrame&&void 0!==a.clearTimeout&&(a.cancelAnimationFrame=function(b){a.clearTimeout(b)})})();Object.create||(Object.create=function(){function a(){}return function(e){if(1!==arguments.length)throw Error("Object.create implementation only accepts one parameter.");a.prototype=e;return new a}}());Array.isArray||(Array.isArray=function(a){return"[object Array]"===
Object.prototype.toString.call(a)});Array.prototype.indexOf||(Array.prototype.indexOf=function(a,e){var d;d=e?e:0;var b;if(!this)throw new TypeError;b=this.length;if(0===b||d>=b)return-1;for(0>d&&(d=b-Math.abs(d));d<b;d++)if(this[d]===a)return d;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(a,e){var d,b;d=0;for(b=this.length;d<b;++d)d in this&&a.call(e,this[d],d,this)});Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var e=Array.prototype.slice.call(arguments,1),d=this,b=function(){},h=function(){return d.apply(this instanceof b&&a?this:a,e.concat(Array.prototype.slice.call(arguments)))};b.prototype=this.prototype;h.prototype=new b;return h});String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};c.AudioContext=c.AudioContext||c.webkitAudioContext||c.mozAudioContext||c.oAudioContext||c.msAudioContext})(window);
(function(c){c=c.RAIMEI;c.extend=function(a,f){f.prototype=Object.create(a.prototype);f.prototype.constructor=f};c.isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};c.maxValue=function(a){return Math.max.apply(null,a)};c.startTime=function(){return 0}})(window);(function(c){c.RAIMEI.Detector=function(){function a(){throw Error("can't create instance");}a.detects=function(){return!!c.AudioContext};return a}()})(window);
(function(c){c.EventDispatcher=function(){function a(){this._listeners={}}var f=a.prototype;f.constructor=c.EventDispatcher;f.addEventListener=function(a,d){"undefined"===typeof this._listeners&&(this._listeners={});var b=this._listeners;"undefined"===typeof b[a]&&(b[a]=[]);-1===b[a].indexOf(d)&&b[a].push(d)};f.hasEventListener=function(a,d){var b=this._listeners;return"undefined"!==typeof b&&"undefined"!==typeof d[a]&&-1!==b[a].indexOf(d)?!0:!1};f.removeEventListener=function(a,d){if("undefined"!==
typeof this._listeners){var b=this._listeners[a],h;"undefined"!==typeof b&&(h=b.indexOf(d),-1!==h&&b.splice(h,1))}};f.dispatchEvent=function(a){var d=this._listeners,b,h;if("undefined"!==typeof d&&"undefined"!==typeof a.type&&(d=d[a.type],"undefined"!==typeof d))for(a.target=this,b=0,h=d.length;b<h;b++)d[b].call(this,a)};a.initialize=function(a){a.addEventListener=f.addEventListener;a.hasEventListener=f.hasEventListener;a.removeEventListener=f.removeEventListener;a.dispatchEvent=f.dispatchEvent};
return a}()})(window.RAIMEI);(function(c){c.RAIMEI.Context=function(){function a(){var a=new c.AudioContext;a.createGain||(a.createGain=a.createGainNode);a.createDelay||(a.createDelay=a.createDelayNode);a.createScriptProcessor||(a.createScriptProcessor=a.createJavaScriptNode);this._context=a}a.prototype.get=function(){return this._context};return a}()})(window);
(function(c){c=c.RAIMEI;var a=c.EventDispatcher;c.BufferLoader=function(){function c(a,b){this._context=a;this._url=b}var e=c.prototype;a.initialize(e);e.load=function(){function a(){g.removeEventListener("load",b);g.removeEventListener("error",h)}function b(){a();e.decodeAudioData(g.response,function(a){a?f.dispatchEvent({type:"load",buffer:a,context:e,currentTarget:g}):f.dispatchEvent({type:"error",error:Error("error decoding file data: "+c),currentTarget:g})},function(a){f.dispatchEvent({type:"error",
error:Error("decode error: "+c+", error: "+a),currentTarget:g})})}function h(){a();f.dispatchEvent({type:"error",error:Error("file not found: "+c),currentTarget:g})}var e=this._context,c=this._url,f=this,g;g=new XMLHttpRequest;g.addEventListener("load",b,!1);g.addEventListener("error",h,!1);g.open("GET",c,!0);g.responseType="arraybuffer";g.send(null)};return c}()})(window);
(function(c){c.RAIMEI.BufferSource=function(){function a(a,c){var d=a.createBufferSource();d.buffer=c;d.start=d.start||d.noteOn;d.stop=d.stop||d.noteOff;this._source=d}a.prototype.getSource=function(){return this._source};return a}()})(window);
(function(c){c.RAIMEI.VolumeControl=function(){function a(a,d){var b=a.createGain();d.connect(b);b.connect(a.destination);this._gainNode=b;this._gain=b.gain}var c=a.prototype;c.setVolume=function(a){this._gain.value=this._normalize(a)};c.getVolume=function(){return this._gain.value};c.getGainNode=function(){return this._gainNode};c.getGain=function(){return this._gain};c._normalize=function(a){0>a?a=0:1<a&&(a=1);return a};return a}()})(window);
(function(c){var a=c.RAIMEI,f=a.EventDispatcher,e=a.isNumeric;a.PlaySoundWithBuffer=function(){function d(a,b,d){this._context=a;this._buffer=b;this._loop=!!d;this._offset=0;this._boundEnded=this._onEnded.bind(this);this._duration=b.duration;this._pause=!1}var b=d.prototype;f.initialize(b);b.start=function(){this._offset=0;this.play(0,0)};b.play=function(a,b){e(b)||(b=0);this._pause=!1;var d=this._createSource(this._context,this._buffer);d.loop=this._loop;d.addEventListener("ended",this._boundEnded,
!1);d.onended=function(){};d.start(this._context.currentTime+a,b);this.dispatchEvent({type:"play",duration:this._duration,delay:a,offset:b,currentTarget:this._source});this._source=d};b.stop=function(){this._stop();this.dispatchEvent({type:"stop",currentTarget:this._source})};b.pause=function(){var a=this._context.currentTime%this._duration;this._dispose();this._stop();this._pause=!0;this._offset=a;this.dispatchEvent({type:"pause",offset:a,currentTarget:this._source})};b.resume=function(){this._pause=
!1;this.play(0,this._offset);this.dispatchEvent({type:"resume",offset:this._offset,currentTarget:this._source})};b.setVolume=function(a){this._volumeControl.setVolume(a)};b.getVolume=function(){return this._volumeControl.getVolume()};b.getDuration=function(){return this._duration};b.getOffset=function(){return this._offset};b.getBuffer=function(){return this._buffer};b.getBufferSource=function(){return this._bufferSource};b.getVolumeControl=function(){return this._volumeControl};b.getContext=function(){return this._context};
b.getSource=function(){return this._source};b._dispose=function(){this._source.removeEventListener("ended",this._boundEnded)};b._stop=function(){var a=this._source;a&&a.stop();this._pause&&(this._pause=!1,this.dispatchEvent({type:"ended",currentTarget:a}))};b._onEnded=function(){var a=this._source;this._offset=0;this.dispatchEvent({type:"ended",currentTarget:a});this._dispose()};b._createSource=function(b,d){var c,e,f;c=new a.BufferSource(b,d);e=c.getSource();f=new a.VolumeControl(b,e);this._bufferSource=
c;this._volumeControl=f;return e};return d}()})(window);(function(c){c.RAIMEI.Octave=function(){function a(){}a.OCTAVE=1200;return a}()})(window);(function(c){c.RAIMEI.Cents=function(){function a(a){this._cents_value=a}var c=a.prototype;c.getCents=function(){return this._cents_value};c.setCents=function(a){this._cents_value=a};return a}()})(window);
(function(c){var a=c.RAIMEI,f=a.Cents,e=a.Octave;a.Semitone=function(){function d(a){f.call(this,100*a);this._semitone_value=a}a.extend(f,d);var b=d.prototype;b.getSemitone=function(){return this._semitone_value};b.setSemitone=function(a){this._semitone_value=a;this.setCents(100*a)};b.shiftOctave=function(a){a=parseInt(a,10)||1;2<a?a=2:-2>a&&(a=-2);this.setSemitone(this._semitone_value+a*e.OCTAVE)};return d}()})(window);
(function(c){var a=c.RAIMEI;a.Oscillator=function(){function c(d,b,e,f){var k=d.createOscillator();this._semitone=b=new a.Semitone(b);k.connect(d.destination);k.frequency.value=f;k.detune.value=b.getCents();k.type=e;k.start=k.start||k.noteOn;k.stop=k.stop||k.noteOff;this._oscillator_node=k}c.SINE=0;c.SQUARE=1;c.SAWTOOTH=2;c.TRIANGLE=3;var e=c.prototype;e.getOscillator=function(){return this._oscillator_node};e.setFrequency=function(a){this._oscillator_node.frequency.value=a};e.setSemitone=function(a){var b=
this._semitone;b.setSemitone(a);this._oscillator_node.detune.value=b.getCents()};e.setType=function(a){this._oscillator_node.type=a};return c}()})(window);
(function(c){var a=c.RAIMEI,f=a.EventDispatcher,e=a.isNumeric;a.PlaySoundWithOscillator=function(){function d(b,d,c,f){this._context=b;this._semitone_value=d;this._type=e(c)?c:a.Oscillator.SINE;this._khz=e(f)?f:440}var b=d.prototype;f.initialize(b);b.start=function(){this.play(0);this.dispatchEvent({type:"start",delay:0,khz:this._khz,semitone:this._semitone_value,wave:this._type,currentTarget:this})};b.play=function(b){var c=this._semitone_value,d=this._type,e=this._khz,f,l;f=new a.Oscillator(this._context,
c,d,e);this._oscillator_node=l=f.getOscillator();this._oscillator=f;l.start(b);this.dispatchEvent({type:"play",delay:b,khz:e,semitone:c,wave:d,currentTarget:l})};b.stop=function(){this._oscillator_node.stop()};b.getOscillator=function(){return this._oscillator_node};b.getType=function(){return this._type};b.setType=function(a){this._type=a};b.getKHZ=function(){return this._khz};b.setKHZ=function(a){this._khz=a};b.getSemitone=function(){return this._semitone_value};b.setSemitone=function(a){this._oscillator.setSemitone(a);
this._semitone_value=a};return d}()})(window);(function(c){var a=c.RAIMEI,f=a.PlaySoundWithOscillator;a.PlaySoundBySine=function(){function c(d,b,e){f.call(this,d,b,a.Oscillator.SINE,e)}a.extend(f,c);return c}()})(window);
