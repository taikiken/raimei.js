/*
 inazumatv.com
 @author (at)taikiken / http://inazumatv.com
 @date 2014/04/19 - 16:37

 Copyright (c) 2011-2014 inazumatv.com, inc.

 Distributed under the terms of the MIT license.
 http://www.opensource.org/licenses/mit-license.html

 This notice shall be included in all copies or substantial portions of the Software.
*/
var RAIMEI={};
(function(e){var b=e.self;b.console=b.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};Date.now||(Date.now=function(){return(new Date).getTime()});(function(){for(var a=0,f=["ms","moz","webkit","o"],d=0;d<f.length&&!b.requestAnimationFrame;++d)b.requestAnimationFrame=b[f[d]+"RequestAnimationFrame"],b.cancelAnimationFrame=b[f[d]+"CancelAnimationFrame"]||b[f[d]+"CancelRequestAnimationFrame"];void 0===b.requestAnimationFrame&&void 0!==b.setTimeout&&
(b.requestAnimationFrame=function(c){var d=Date.now(),f=Math.max(0,16-(d-a)),e=b.setTimeout(function(){c(d+f)},f);a=d+f;return e});void 0===b.cancelAnimationFrame&&void 0!==b.clearTimeout&&(b.cancelAnimationFrame=function(c){b.clearTimeout(c)})})();Object.create||(Object.create=function(){function a(){}return function(f){if(1!==arguments.length)throw Error("Object.create implementation only accepts one parameter.");a.prototype=f;return new a}}());Array.isArray||(Array.isArray=function(a){return"[object Array]"===
Object.prototype.toString.call(a)});Array.prototype.indexOf||(Array.prototype.indexOf=function(a,f){var d;d=f?f:0;var c;if(!this)throw new TypeError;c=this.length;if(0===c||d>=c)return-1;for(0>d&&(d=c-Math.abs(d));d<c;d++)if(this[d]===a)return d;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(a,f){var d,c;d=0;for(c=this.length;d<c;++d)d in this&&a.call(f,this[d],d,this)});Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var f=Array.prototype.slice.call(arguments,1),d=this,c=function(){},b=function(){return d.apply(this instanceof c&&a?this:a,f.concat(Array.prototype.slice.call(arguments)))};c.prototype=this.prototype;b.prototype=new c;return b});String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};e.AudioContext=e.AudioContext||e.webkitAudioContext||e.mozAudioContext||e.oAudioContext||e.msAudioContext})(window);
(function(e){e=e.RAIMEI;e.extend=function(b,a){a.prototype=Object.create(b.prototype);a.prototype.constructor=a};e.isNumeric=function(b){return!isNaN(parseFloat(b))&&isFinite(b)};e.maxValue=function(b){return Math.max.apply(null,b)};e.startTime=function(){return 0}})(window);(function(e){e.RAIMEI.Detector=function(){function b(){throw Error("can't create instance");}b.detects=function(){return!!e.AudioContext};return b}()})(window);
(function(e){e.EventDispatcher=function(){function b(){this._listeners={}}var a=b.prototype;a.constructor=e.EventDispatcher;a.addEventListener=function(f,d){"undefined"===typeof this._listeners&&(this._listeners={});var c=this._listeners;"undefined"===typeof c[f]&&(c[f]=[]);-1===c[f].indexOf(d)&&c[f].push(d)};a.hasEventListener=function(f,d){var c=this._listeners;return"undefined"!==typeof c&&"undefined"!==typeof d[f]&&-1!==c[f].indexOf(d)?!0:!1};a.removeEventListener=function(f,d){if("undefined"!==
typeof this._listeners){var c=this._listeners[f],a;"undefined"!==typeof c&&(a=c.indexOf(d),-1!==a&&c.splice(a,1))}};a.dispatchEvent=function(a){var d=this._listeners,c,b;if("undefined"!==typeof d&&"undefined"!==typeof a.type&&(d=d[a.type],"undefined"!==typeof d))for(a.target=this,c=0,b=d.length;c<b;c++)d[c].call(this,a)};b.initialize=function(b){b.addEventListener=a.addEventListener;b.hasEventListener=a.hasEventListener;b.removeEventListener=a.removeEventListener;b.dispatchEvent=a.dispatchEvent};
return b}()})(window.RAIMEI);(function(e){e.RAIMEI.Context=function(){function b(){var a=new e.AudioContext;a.createGain||(a.createGain=a.createGainNode);a.createDelay||(a.createDelay=a.createDelayNode);a.createScriptProcessor||(a.createScriptProcessor=a.createJavaScriptNode);this._context=a}b.prototype.get=function(){return this._context};return b}()})(window);
(function(e){e=e.RAIMEI;var b=e.EventDispatcher;e.BufferLoader=function(){function a(d,c){this._context=d;this._url=c}var f=a.prototype;b.initialize(f);f.load=function(){function d(){g.removeEventListener("load",c);g.removeEventListener("error",a)}function c(){d();b.decodeAudioData(g.response,function(a){a?e.dispatchEvent({type:"load",buffer:a,context:b,currentTarget:g}):e.dispatchEvent({type:"error",error:Error("error decoding file data: "+f),currentTarget:g})},function(a){e.dispatchEvent({type:"error",
error:Error("decode error: "+f+", error: "+a),currentTarget:g})})}function a(){d();e.dispatchEvent({type:"error",error:Error("file not found: "+f),currentTarget:g})}var b=this._context,f=this._url,e=this,g;g=new XMLHttpRequest;g.addEventListener("load",c,!1);g.addEventListener("error",a,!1);g.open("GET",f,!0);g.responseType="arraybuffer";g.send(null)};return a}()})(window);
(function(e){e.RAIMEI.BufferSource=function(){function b(a,b){var d=a.createBufferSource();d.buffer=b;d.start=d.start||d.noteOn;d.stop=d.stop||d.noteOff;this._source=d}b.prototype.getSource=function(){return this._source};return b}()})(window);
(function(e){e.RAIMEI.VolumeControl=function(){function b(a,b){var c=a.createGain();b.connect(c);c.connect(a.destination);this._gainNode=c;this._gain=c.gain}var a=b.prototype;a.setVolume=function(a){this._gain.value=this._normalize(a)};a.getVolume=function(){return this._gain.value};a.getGainNode=function(){return this._gainNode};a.getGain=function(){return this._gain};a._normalize=function(a){0>a?a=0:1<a&&(a=1);return a};return b}()})(window);
(function(e){var b=e.RAIMEI,a=b.EventDispatcher,f=b.isNumeric;b.PlaySoundWithBuffer=function(){function d(a,b,c){this._context=a;this._buffer=b;this._loop=!!c;this._offset=0;this._boundEnded=this._onEnded.bind(this);this._duration=b.duration;this._pause=!1}var c=d.prototype;a.initialize(c);c.start=function(){this._offset=0;this.play(0,0)};c.play=function(a,b){f(b)||(b=0);this._pause=!1;var c=this._createSource(this._context,this._buffer);c.loop=this._loop;c.addEventListener("ended",this._boundEnded,
!1);c.onended=function(){};c.start(this._context.currentTime+a,b);this.dispatchEvent({type:"start",duration:this._duration,delay:a,offset:b,currentTarget:this._source});this._source=c};c.stop=function(){this._stop();this.dispatchEvent({type:"stop",currentTarget:this._source})};c.pause=function(){var a=this._context.currentTime%this._duration;this._dispose();this._stop();this._pause=!0;this._offset=a;this.dispatchEvent({type:"pause",offset:a,currentTarget:this._source})};c.resume=function(){this._pause=
!1;this.play(0,this._offset);this.dispatchEvent({type:"resume",offset:this._offset,currentTarget:this._source})};c.setVolume=function(a){this._volumeControl.setVolume(a)};c.getVolume=function(){return this._volumeControl.getVolume()};c.getDuration=function(){return this._duration};c.getOffset=function(){return this._offset};c.getBuffer=function(){return this._buffer};c.getBufferSource=function(){return this._bufferSource};c.getVolumeControl=function(){return this._volumeControl};c.getContext=function(){return this._context};
c.getSource=function(){return this._source};c._dispose=function(){this._source.removeEventListener("ended",this._boundEnded)};c._stop=function(){var a=this._source;a&&a.stop();this._pause&&(this._pause=!1,this.dispatchEvent({type:"ended",currentTarget:a}))};c._onEnded=function(){var a=this._source;this._offset=0;this.dispatchEvent({type:"ended",currentTarget:a});this._dispose()};c._createSource=function(a,c){var d,e,f;d=new b.BufferSource(a,c);e=d.getSource();f=new b.VolumeControl(a,e);this._bufferSource=
d;this._volumeControl=f;return e};return d}()})(window);
